{% extends "base.html" %}

{% block title %}Detector de Latas - EcoPuntos{% endblock %}

{% block content %}
<div class="container">
    <div class="detector-header">
        <h1>游닝 Detector de Reciclables</h1>
        <p>Coloca objetos de pl치stico, metal o cart칩n frente a la c치mara para ganar puntos</p>
    </div>
    
    <div class="detector-stats">
        <div class="detector-stat">
            <span class="stat-label">Puntos:</span>
            <span class="stat-value" id="current-points">{{ user.points }}</span>
        </div>
        <div class="detector-stat">
            <span class="stat-label">Objetos detectados hoy:</span>
            <span class="stat-value" id="cans-today">{{ user.cans_detected }}</span>
        </div>
    </div>
    
    <div class="detector-container">
        <div class="video-section">
            <div class="video-wrapper">
                <video id="video" autoplay playsinline></video>
                <canvas id="canvas" style="display: none;"></canvas>
                <div class="detection-overlay" id="detection-overlay" style="display: none;"></div>
            </div>
            <div id="camera-status" class="camera-status">Estado: inactivo</div>

            <div class="video-controls">
                <button id="start-camera" class="btn btn-primary">Iniciar C치mara</button>
            </div>
        </div>
        
        <div class="detection-info">
            <div class="detection-log">
                <h4>游닇 Registro de Detecciones</h4>
                <div id="detection-log" class="log-content">
                    <p class="log-empty">Esperando detecciones...</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/detector.js') }}"></script>
<!-- Cargar TensorFlow.js y COCO-SSD optimizado -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.14.0/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.3/dist/coco-ssd.min.js"></script>
{% endblock %}
